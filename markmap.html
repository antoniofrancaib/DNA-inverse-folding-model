<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.8/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.8/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.8/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:x,mm:K}=window,P=new x.Toolbar;P.attach(K);const F=P.render();F.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(F)})})()</script><script>((b,L,T,D)=>{const H=b();window.mm=H.Markmap.create("svg#mindmap",(L||H.deriveOptions)(D),T)})(()=>window.markmap,null,{"content":"gRNAde Forward Pass","children":[{"content":"Encoder Phase","children":[{"content":"Input Features (<code>featurizer.py</code>)","children":[{"content":"<strong>Nodes</strong>:","children":[{"content":"<code>node_s</code>: (N, C, 15)<br>\n<em>3 atoms × [cos(δ), sin(δ), cos(θ), sin(θ), log(l)]</em>","children":[],"payload":{"tag":"li","lines":"6,8"}},{"content":"<code>node_v</code>: (N, C, 4, 3)<br>\n<em>[P→C4', C4'→N, forward, backward] vectors</em>","children":[],"payload":{"tag":"li","lines":"8,10"}}],"payload":{"tag":"li","lines":"5,10"}},{"content":"<strong>Edges</strong>:","children":[{"content":"<code>edge_s</code>: (E, C, 131)<br>\n<em>32 RBF + 32 posenc + 3 log-dist</em>","children":[],"payload":{"tag":"li","lines":"11,13"}},{"content":"<code>edge_v</code>: (E, C, 3, 3)<br>\n<em>P/C4'/N displacement vectors</em>","children":[],"payload":{"tag":"li","lines":"13,15"}},{"content":"<code>edge_index</code>: (2, E) (KNN graph)","children":[],"payload":{"tag":"li","lines":"15,17"}}],"payload":{"tag":"li","lines":"10,17"}}],"payload":{"tag":"h3","lines":"4,5"}},{"content":"Embedding (<code>models.py</code>)","children":[{"content":"<strong>Node GVP</strong>: (15,4) → (128,16)","children":[{"content":"<code>node_s → (N,C,128)</code>","children":[],"payload":{"tag":"li","lines":"19,20"}},{"content":"<code>node_v → (N,C,16,3)</code>","children":[],"payload":{"tag":"li","lines":"20,21"}}],"payload":{"tag":"li","lines":"18,21"}},{"content":"<strong>Edge GVP</strong>: (131,3) → (64,4)","children":[{"content":"<code>edge_s → (E,C,64)</code>","children":[],"payload":{"tag":"li","lines":"22,23"}},{"content":"<code>edge_v → (E,C,4,3)</code>","children":[],"payload":{"tag":"li","lines":"23,25"}}],"payload":{"tag":"li","lines":"21,25"}}],"payload":{"tag":"h3","lines":"17,18"}},{"content":"Message Passing (<code>layers.py</code>)","children":[{"content":"4x MultiGVPConvLayer","children":[{"content":"Preserves shapes:","children":[{"content":"Nodes: (N,C,128), (N,C,16,3)","children":[],"payload":{"tag":"li","lines":"28,29"}},{"content":"Edges: (E,C,64), (E,C,4,3)","children":[],"payload":{"tag":"li","lines":"29,30"}}],"payload":{"tag":"li","lines":"27,30"}},{"content":"Mechanism:<pre data-lines=\"31,34\"><code class=\"language-python\">message = tuple_cat(s_j, v_j, edge_attr, s_i, v_i)\n</code></pre>","children":[],"payload":{"tag":"li","lines":"30,35"}}],"payload":{"tag":"li","lines":"26,35"}}],"payload":{"tag":"h3","lines":"25,26"}},{"content":"Pooling (<code>models.py</code>)","children":[{"content":"<strong>Masked Mean</strong>:","children":[{"content":"Nodes: (N,128), (N,16,3)","children":[],"payload":{"tag":"li","lines":"37,38"}},{"content":"Edges: (E,64), (E,4,3)","children":[],"payload":{"tag":"li","lines":"38,40"}}],"payload":{"tag":"li","lines":"36,40"}}],"payload":{"tag":"h3","lines":"35,36"}}],"payload":{"tag":"h2","lines":"2,3"}},{"content":"Decoder Phase","children":[{"content":"Input to Decoder","children":[{"content":"<strong>Pooled Features</strong>:","children":[{"content":"Nodes: (N,128), (N,16,3)","children":[],"payload":{"tag":"li","lines":"44,45"}},{"content":"Edges: (E,64), (E,4,3)","children":[],"payload":{"tag":"li","lines":"45,46"}}],"payload":{"tag":"li","lines":"43,46"}},{"content":"<strong>Sequence Context</strong>:","children":[{"content":"<code>h_S = Embed(seq) → (N,4)</code>","children":[],"payload":{"tag":"li","lines":"47,49"}}],"payload":{"tag":"li","lines":"46,49"}}],"payload":{"tag":"h3","lines":"42,43"}},{"content":"Autoregressive Layers (<code>models.py</code>)","children":[{"content":"4x GVPConvLayer","children":[],"payload":{"tag":"li","lines":"50,51"}},{"content":"<strong>Key Operations</strong>:","children":[{"content":"1. Edge Context Injection:","children":[{"content":"<code>edge_s = (E,64+4=68)</code>","children":[],"payload":{"tag":"li","lines":"53,54"}}],"payload":{"tag":"li","lines":"52,54","listIndex":1}},{"content":"2. Causal Masking:<pre data-lines=\"55,58\"><code class=\"language-python\">mask = src &lt; dst  <span class=\"hljs-comment\"># layers.py:94-97</span>\n</code></pre>","children":[],"payload":{"tag":"li","lines":"54,58","listIndex":2}},{"content":"3. Message Aggregation:","children":[{"content":"Geometric + Sequence features","children":[],"payload":{"tag":"li","lines":"59,61"}}],"payload":{"tag":"li","lines":"58,61","listIndex":3}}],"payload":{"tag":"li","lines":"51,61"}}],"payload":{"tag":"h3","lines":"49,50"}},{"content":"Output Projection","children":[{"content":"<strong>Final GVP</strong>: (128,16) → (4,0)","children":[{"content":"<code>logits: (N,4)</code>","children":[],"payload":{"tag":"li","lines":"63,65"}}],"payload":{"tag":"li","lines":"62,65"}}],"payload":{"tag":"h3","lines":"61,62"}},{"content":"Sampling (<code>models.py</code>)","children":[{"content":"<strong>Autoregressive Decoding</strong>:<pre data-lines=\"67,71\"><code class=\"language-python\"><span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">0.</span>.N-<span class=\"hljs-number\">1</span>:\n    edge_mask = edge_index[<span class=\"hljs-number\">1</span>] == i\n    seq[i] ∼ Categorical(logits_i)  <span class=\"hljs-comment\"># lines 113-148</span></code></pre>","children":[],"payload":{"tag":"li","lines":"66,71"}}],"payload":{"tag":"h3","lines":"65,66"}}],"payload":{"tag":"h2","lines":"40,41"}}],"payload":{"tag":"h1","lines":"0,1"}},null)</script>
</body>
</html>
